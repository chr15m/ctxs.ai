---
import Layout from "../layouts/Layout.astro";
import { getCollection, type CollectionEntry } from "astro:content";

// Welcome to Astro! Wondering what to do next? Check out the Astro documentation at https://docs.astro.build
// Don't want to use any of this? Delete everything in this file, the `assets`, `components`, and `layouts` directories, and start fresh.
const contexts = await getCollection("contexts");
---

<Layout>
	<div class="max-w-2xl mx-auto px-4 sm:px-6 py-12">
		<h1 class="text-4xl font-bold text-gray-900 mb-8">
			Available Contexts
		</h1>

		<div class="space-y-6">
			{
				contexts.map((context) => {
					const author = context.id.split("/")[0];
					return (
						<div class="bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-shadow duration-300">
							<div class="p-6">
								<h2 class="text-xl font-semibold text-gray-900 mb-2">
									{context.data.title || "Untitled Context"}
								</h2>

								{context.data.description && (
									<p class="text-gray-600 mb-4">
										{context.data.description}
									</p>
								)}

								<div class="space-y-2">
									<div class="flex items-center text-sm text-gray-500">
										<svg
											xmlns="http://www.w3.org/2000/svg"
											class="h-5 w-5 mr-2"
											viewBox="0 0 20 20"
											fill="currentColor"
										>
											<path
												fill-rule="evenodd"
												d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
												clip-rule="evenodd"
											/>
										</svg>
										<span>@{author}</span>
									</div>

									{context.data.provenance && (
										<div class="flex items-center text-sm text-gray-500">
											<svg
												xmlns="http://www.w3.org/2000/svg"
												class="h-5 w-5 mr-2"
												viewBox="0 0 20 20"
												fill="currentColor"
											>
												<path
													fill-rule="evenodd"
													d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm3 1h6v4H7V5zm8 8v2h-2v-2h2zm-3 0v2H9v-2h3zm-4 0v2H6v-2h2zM7 7h6v4H7V7z"
													clip-rule="evenodd"
												/>
											</svg>
											<span>
												{context.data.provenance}
											</span>
										</div>
									)}
								</div>

								<div class="mt-6">
									<a
										href={`/gh/${context.id}`}
										class="inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 w-full"
									>
										View Context
										<svg
											xmlns="http://www.w3.org/2000/svg"
											class="h-4 w-4 ml-2"
											viewBox="0 0 20 20"
											fill="currentColor"
										>
											<path
												fill-rule="evenodd"
												d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
												clip-rule="evenodd"
											/>
										</svg>
									</a>
								</div>
							</div>
						</div>
					);
				})
			}
		</div>
	</div>
</Layout>
